version: 3.1
condition: command_exists "rpm"
output_directory: /live_response/packages
artifacts:
  -
    description: Displays all installed packages.
    supported_os: [aix, linux]
    collector: command
    command: rpm -q -a
    output_file: rpm_-q_-a.txt
  -
    description: Display all installed packages name, install date, version and release.
    supported_os: [aix, linux]
    collector: command
    command: rpm -q -a --queryformat '%{INSTALLTIME}~%{NAME}~%{VERSION}-%{RELEASE}\\n'
    output_file: rpm_-q_-a_--queryformat_installtime_name_version_release.txt
  -
    description: Verify all packages to compare information about the installed files in the package with information about the files taken from the package metadata stored in the rpm database.
    supported_os: [aix, linux]
    collector: command
    command: rpm -V -a
    output_file: rpm_-V_-a.txt
  -
    description: List filenames under /usr/sbin/.
    supported_os: [aix, linux]
    collector: find
    path: /usr/sbin/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /usr/bin/.
    supported_os: [aix, linux]
    collector: find
    path: /usr/bin/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /opt/.
    supported_os: [aix, linux]
    collector: find
    path: /opt/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /usr/local/.
    supported_os: [aix, linux]
    collector: find
    path: /usr/local/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: Search for a filename from installed packages.
    supported_os: [aix, linux]
    collector: command
    foreach: cat /%temp_directory%/live_response/packages/binary_files.txt
    command: rpm -q -f "%line%" | sed 's|$|: %line%|'
    output_directory: /live_response/packages
    output_file: rpm_-q_-f.txt

version: 2.1
condition: command_exists "dpkg"
output_directory: /live_response/packages
artifacts:
  -
    description: Display installed packages.
    supported_os: [linux]
    collector: command
    command: dpkg -l
    output_file: dpkg_-l.txt
  -
    description: Verify all packages to compare information about the installed files in the package with information about the files taken from the package metadata stored in the dpkg database.
    supported_os: [linux]
    collector: command
    command: dpkg -V
    output_file: dpkg_-V.txt
  -
    description: List filenames under /sbin/.
    supported_os: [linux]
    collector: find
    path: /sbin/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /usr/sbin/.
    supported_os: [linux]
    collector: find
    path: /usr/sbin/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /bin/.
    supported_os: [linux]
    collector: find
    path: /bin/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /usr/bin/.
    supported_os: [linux]
    collector: find
    path: /usr/bin/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /opt/.
    supported_os: [linux]
    collector: find
    path: /opt/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: List filenames under /usr/local/.
    supported_os: [linux]
    collector: find
    path: /usr/local/*
    file_type: [f, l]
    output_directory: /%temp_directory%/live_response/packages
    output_file: binary_files.txt
  -
    description: Search for a filename from installed packages.
    supported_os: [linux]
    collector: command
    foreach: cat /%temp_directory%/live_response/packages/binary_files.txt
    command: dpkg -S "%line%" 2>&1
    output_directory: /live_response/packages
    output_file: dpkg_-S.txt
